# SAFE for users

This section covers the use of SAFE to:

  - Manage your personal details and preferences
  - Manage your user accounts on different systems and services


!!! warning
    This document is currently under development and may be incomplete and/or misleading in places.
    Please continue to refer to the [existing documentation](http://www.archer.ac.uk/documentation/safe-guide/)
    until this work is completed and this warning removed.




[SAFE](https://safe.epcc.ed.ac.uk/) is an online service management system developed by [EPCC](https://www.epcc.ed.ac.uk).
Through SAFE, individual users can request machine accounts, reset passwords, see available resources and track their usage. 
All users must be registered on SAFE before they can apply for their machine account.


## <a id="reg-log-pass"></a>Registering, logging in, passwords

### <a id="register"></a>How to register on SAFE

1. Go to the <a href="https://safe.epcc.ed.ac.uk/">SAFE logon page </a>
2. Click "Create an account"
3. Fill in your personal details.  You can come back later and change them if you wish
4. Click "Register"
5. You are now registered. Your SAFE password will be emailed to the email address you
   provided. You can then login with that email address and password


At this point your account is registered on the SAFE but you do not have a machine account on the service machine.
To obtain a machine account you should follow the steps to [Request a machine account](#getac).

<a id="personssh"></a>
!!! Hint
    If you are going to be requesting a machine account and logging onto the service machine, you may
    want to create a password-protected ssh key pair and upload the public key into SAFE as part of your Personal Details. 
    A key uploaded here will be used as the default key for any machine account you request.

### <a id="login"></a> How to login to SAFE and Overview of Main Page

1. Go to the SAFE logon page [https://safe.epcc.ed.ac.uk/](https://safe.epcc.ed.ac.uk/)
2. Type in the email address you have registered with
3. Type in your SAFE password
4. Click "Login"
5. You are now on the Main Page and here you can see Menus along the top which give access to SAFE functionality


### <a id="2fac"></a> How to turn on 2-factor authentication to SAFE

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select *Set 2 factor token*.  A scanable QR code will be displayed.
2. Install a suitable smart-phone app such as 
google-authenticator ([android](https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2), [ios](http://appstore.com/googleauthenticator)) on your phone or mobile device.
3. Follow the app instructions to add a new account and scan the displayed QR code (or type in the dispayed 26 character key).
4. Type the verification code generated by the app into the *Verification code* box.
5. Click *Set*

2-Factor Authentication is now enabled.  
Each time you log in to the SAFE, in additon to requesting your SAFE password or Institutional
login, you will also be asked for the current 6-digit authentication code from the app.

### How to turn off 2-Factor Authentication on SAFE

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select *Disable 2 factor authentication.*

### <h3 id="details"></a> How to change your personal details on SAFE

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select  *Update personal details*
2. Make the changes you wish
3. Click *Update* to save the changes
4. Go back to *Your details* and you will see the revised information

Do not forget the *Update* step, or nothing will happen. Note that your postal address does
not automatically include the name of your department and institution; if you want these in
your postal address, you must type them again as part of Address Lines 1-4.

### <a id="chemail"></a> How to change your email address on SAFE

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select *Update email*
2. Enter the new email address and click *Request*

A verification email will then be sent to the new email address. This email contains a link
which you must use to verify your new address. On acknowledging your new address the change
will be committed and you must   use the new email address when logging into SAFE

### <a id="chpass"></a> How to change your SAFE website password
[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select *Change website password*
1. Type in the new password, and then again to confirm, and click *Change*

### <a id="reset"></a> How to reset your SAFE password

Go to the SAFE logon page [https://safe.epcc.ed.ac.uk](https://safe.epcc.ed.ac.uk).  Then:

1. Click *Forgot password?* next to the *Login* button
1. Enter your email address
1. Click *Send password recovery email*
1. SAFE will mail you a one-time password reset link

SAFE will only mail a password reset link to email addresses already registered in SAFE. 

Of course, anyone could go to SAFE, click "Forgot password?", and type your email address. If
that happens you will receive an email message out of the blue with a password recovery link.
This can be safely ignored - no changes will be made if the link is not used.

## <a id="machac"></a> Your user account on the service machine

### <a id="getac"></a> How to request a machine account

[Login to SAFE](#login). Then:

1. Go to the Menu *Login accounts* and select *Request login account* 
1. Choose the project you want the account for in the "Project" box.  
1. Click "Next"
1. Select the machine you want the account for from the available machines. 
1. Click "Next"
1. Enter the username you would prefer to use on the service machine <br>
1. Click "Request"
	
!!! notes
    Every username must be unique.  Some machines including ARCHER2 and Cirrus require you to
    create a new machine account with a unique username for each project you work on.  
    Usernames cannot be used on multiple projects, even if the previous project has finished.  
    Some machines require you to have set up an ssh key in SAFE before you can request your
    machine account.

!!! hint
    If you set up an ssh key under "Personal Details" in SAFE, then that key will be used now
    as the default ssh key for your new account. If you do not have any ssh key set up then you
    may need to create a password-protected ssh key pair and upload the public key in SAFE.
    You can add a default key for all new accounts under your
    ["Personal Details"](#how-to-change-your-personal-details-on-safe), or add a key specific
    to this account using the "Add Credential" button.
		
Next you will be asked to accept the Service Terms and Conditions of Access, by clicking the
appropriate button.  When you do this, you will be sent an  acknowledgment by email.

Now you have to wait for your PI or project manager to accept your request to register. When
this has happened, the systems team are prompted to create your account on the service machine.
Once this has been done, you will be sent an email. You can then
[pick up your password](#getpass) for the service machine from your SAFE account.


### <a id="accguest"></a> How to request access to a guest budget

A guest budget is a budget in one project which has been set up to permit access requests from
users in a different project.

[Login to SAFE](#login). Then:


1. Go to the Menu *Login accounts* and select the login account you want to use to access the
   guest budget
2. Click on *Request group/budget* 
   then from the drop-down list *Group to request* select the guest budget that you wish to use. 
3. Click on the *Request* button.

The request will be sent to the PI of the project of the guest budget and once the request has
been approved then you will be able to use the guest budget code in your jobs submit scripts.

### <h3 id="reset_machine"></a> How to reset a password on your machine account

If you still remember your current machine account password, you can simply log in to the service
machine as normal and then use the `passwd` command.

```
passwd
```

You will then be prompted to enter your current password, and then your new password twice.
Your password must comply with the [password policy](https://www.archer2.ac.uk/about/policies/passwords_usernames).

If you have forgotten your current password, or it has expired, then you can ask for it to be reset:

[Login to SAFE](#login). Then:

1. Go to the Menu *Login accounts* and select the account you need the new password for
2. Click *username* which displays details of this service machine account.
3. Click * Request Password Reset*
4. Click *Yes* to confirm

Now the systems team will change your password. When this has been done, you will be informed by email;
this means that you can come back to SAFE and [pick up your new password](#getpass).

### <h3 id="getpass"></a> How can I pick up my password for the service machine?

Wait till you receive the email with your details.  Then:


1. [Login to SAFE](#login). 
2. Go to the Menu *Login accounts* and click on the account username for which you want to look up
   the password. This will display details of your account. 
3. Click *View Login Account Password*
4. Your password to the service machine will be displayed
  

This password is generated randomly by the software. It's best to copy-and-paste it across when you
log in to the service machine.
	
After you login, you will be prompted to change it. You should paste in the password retreived from
SAFE again, and then you will be prompted to type in your new, easy-to-remember password, twice. 
Your password must comply with the  [Service password policy](https://www.archer2.ac.uk/about/policies/passwords_usernames).
	
Note that when you change your password on the service machine  in this way, this is not reflected on the SAFE.
	 
## <a id="package-group"></a> How to request access to a Package Group

Some software which is installed on ARCHER2 can only be accessed once the user's license has been confirmed.

For some of these packages, such as VASP and CASTEP you can request access via SAFE.

[Login to SAFE](#login). Then:

1. Go to the Menu *Login accounts* and select the account which requires access to the package
2. Click "Request Access to Package"
3. Select the package from the list of available packages and click "Select"
4. Fill in as much information as possible about your license, at the very least, the information
   requested at the top of the screen such as the licence holder's name and contact details. If
   you are covered by the license because the licence holder is your supervisor, for example,
   please state this.
5. Click "Submit"

Your request will then be processed by the service support team who will confirm your license with the package
developers before enabling your access to the package on the service machine.  This can take several days but
you will be advised once this has been done.

If you require access to a package which does not yet appear in the list of available packages then please
just send an email to the Service Desk to request access.  

## <a id="user-mailing"></a> User Mailing Options

### <a id="mailings"></a> How to view user mailings

All mailings are archived and can be viewed in [SAFE](https://safe.epcc.ed.ac.uk/). 

[Login to SAFE](#login). Then:

1. Select "Service information"
2. Select the mailing type you wish to read
3. Click on "View"

### <a id="mlist"></a> How to get added to, or removed from the email mailing list?

There are three mailing list options available.</p>

1. The *Major Announcements* mailings will contain information on major service upgrades and future plans.
   This option is enabled for all users by default. 
2. The *Service News* mailings will contain information on training courses, newsletters, events, and other
   general announcements. This option is enabled for all users by default.
3. The *System Status Notifications* will inform users when the service goes up or down, including the
   reminders of the next planned maintenance shutdowns. This option is not enabled by default, those
   wishing to receive this information will need to explicitly subscribe to it.
  
Any combination of these three options may be selected via SAFE:

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* click *Update Email settings*
2. In the panel headed *Update email settings* make sure there are ticks beside the options you would
   like to subscribe to.
3. Click *Update List Preferences*

!!! Important
    **Note 1:** There is an option to unsubscribe from the user mailings completely, which overrides any
    option enabled in *Mailing list preferences* panel. This will be set automatically to unsubscribe you
    if mailings sent to an email address are returned to us as "undeliverable". If you change your email
    address we recommend you check you have not been unsubscribed if your previous email address had gone
    out of service.

1. Click on the Menu *Your details* 
2. Click *Update personal details* 
3. Tick *Opt out of user emails* field to unsubscribe, remove the tick to re-subscribe
4. Click *Update* at the foot of the screen           

Do not forget the *Update* step, or nothing will happen.

!!! Important
    **Note 2:** Regardless of whether you are subscribed to a particular mailing list, you can still view
    ALL user mailings which have been sent, in SAFE. See [here](#mailings)  for details. 

## <a id="tracking"></a> Tracking and Managing Available Resources

### <a id="ures"></a> How to check how much time and space are available to you

[Login to SAFE](#login). Then:

Go to the Menu *Login accounts*, select the *username* which you wish to 
see details for.  

You will then see the information for this account. You will see the quotas for the disk space (if the
project group is using these) and how much is in use.  You can also see which file systems your project
is using under the heading 'Volume', followed by the current usage by your project, and total quota.
Quotas that are close to being full are hightlighted.

The budget values displayed are updated every morning, and the values shown for disk use are updated
four times a day. For this reason, all these values may not be completely up-to-date. If there is a
lot of activity in your project, the numbers shown could be significantly different from from the
current ones.

### <a id="resources"></a> How to request more budget or disk space

In the first instance, please contact the principal investigator, or the project manager of your project.
The PI will then take the necessary steps to either allocate you more resources out of the project
reserve, or to request an increase from the service desk/research councils.

The Service desk does not own project resources and has no authority to allocate them to individual users.
This responsibility lies with the project PI/project manager.

### <a id="uhist"></a> How to review the use you have made of the service, or the activity of the service as a whole

[Login to SAFE](#login). Then:

1. Go to the Menu *Service information* and select *Reports*
2. Select the report you wish to run
3. Complete the required information in the form: this will usually consist of at least a date range to
   analyse and may have other options depending on the report you are running.
4. Click on the output format you want to use (Preview, HTML, PDF, CSV)

The report will be generated and displayed.
	
If you initially selected Preview and would now like this report in one of the other formats, scroll down
to the bottom of the report and you can now click the format you want and the same report parameters will
be used to generate the report.

If you are a PI or Project Manager, you will have access to additional reports to generate information on
whole projects or groups as well as your own usage and the usage of the service as a whole.

## <a id="pubs"></a> Tracking Publications (DOI)

The SAFE includes functionality for tracking pulications associated with
projects by registering DOI (Digital Object Identifiers) and automatically
collecting metadata.

Once registerd, lists of DOIs can be exported in a format suitable for
uploading to ResearchFish.

This functionality can be particularly useful for large projects where 
there is a requirement to capture outputs from a large number of users.

### <a id="regdoi"></a> How to register a publication in SAFE

You will need a DOI for the publication you wish to register. A DOI 
has the form of an set of ID strings separated by slashes. For example,
`10.7488/ds/1505`, you should not include the web host address which
provides a link to the DOI.

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select *Publications* 
2. Select the project you wish to associate the publication with from the list and click *View*.
3. The next page will list currently registered publications, to add one click *Add*.
4. Enter the DOI in the text field provided and click *Add*

### <a id="listdoi"></a> How to list your publications in SAFE

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select *Publications* 
2. Select the project you wish to list the publications from using the dropdown menu and click *View*.
3. The next page will list your currently registered publications.

### <a id="exportdoi"></a> How to export your publications from SAFE

At the moment we support export lists of DOIs to comma-separated values (CSV) files. This
does not export all the metadata, just the DOIs themselves with a maximum of 25 DOIs per line.
This format is primarily useful for importing into ResearchFish (where you can paste in the
comma-separated lists to import publications). We plan to add further export formats in the future.

[Login to SAFE](#login). Then:

1. Go to the Menu *Your details* and select *Publications* 
2. Select the project you wish to list the publications from using the dropdown menu and click *View*.
3. The next page will list your currently registered publications.
4. Click *Export* to generate a plain text comma-separated values (CSV)   file that lists all DOIs.
5. If required, you can save this file using the Save command your web browser.

## <a id="miscellaneous"></a> Miscellaneous

### <a id="checkq"></a> How to check the queries you have submitted to the service desk
[Login to SAFE](#login). Then:

1. Go to the Menu *Help and Support * and select *Your support requests* 
2. Click the Query ID of a query to check the contents of the query log

This will show you the queries of yours that have not yet been resolved. Note that some of
the internal correspondence about a query will not be shown.  

You can also use SAFE to submit a query &mdash; use *Submit support request*.
	
### <a id="delacc"></a> How to delete your user account

Please check the Service policy on on end of life procedures for user accounts.

If you wish your user account on the Service machine to be deleted, please contact the
Service Desk giving the username to be deleted. Service desk staff will arrange for the
account to be deleted, in line with the policy.  




